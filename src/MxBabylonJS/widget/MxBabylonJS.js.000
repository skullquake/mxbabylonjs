require(
	{
		packages:[
			/*
			 * local
			{
				name:"_ammo",
				location:"/widgets/MxBabylonJS/lib/babylonjs",
				main:"ammo"
			},
			{
				name:"_babylon",
				location:"/widgets/MxBabylonJS/lib/babylonjs",
				main:"babylon"
			},
			{
				name:"_babylon.max",
				location:"/widgets/MxBabylonJS/lib/babylonjs",
				main:"babylon.max"
			},
			{
				name:"_babylon.no-module.max",
				location:"/widgets/MxBabylonJS/lib/babylonjs",
				main:"babylon.no-module.max"
			},
			{
				name:"_babylon.worker",
				location:"/widgets/MxBabylonJS/lib/babylonjs",
				main:"babylon.worker"
			},
			{
				name:"_cannon",
				location:"/widgets/MxBabylonJS/lib/babylonjs",
				main:"cannon"
			},
			{
				name:"_draco_decoder_gltf",
				location:"/widgets/MxBabylonJS/lib/babylonjs",
				main:"draco_decoder_gltf"
			},
			{
				name:"_draco_wasm_wrapper_gltf",
				location:"/widgets/MxBabylonJS/lib/babylonjs",
				main:"draco_wasm_wrapper_gltf"
			},
			{
				name:"_earcut.min",
				location:"/widgets/MxBabylonJS/lib/babylonjs",
				main:"earcut.min"
			},
			{
				name:"_es6",
				location:"/widgets/MxBabylonJS/lib/babylonjs",
				main:"es6"
			},
			{
				name:"_gltf_validator",
				location:"/widgets/MxBabylonJS/lib/babylonjs",
				main:"gltf_validator"
			},
			{
				name:"_babylon.gui",
				location:"/widgets/MxBabylonJS/lib/babylonjs/gui",
				main:"babylon.gui"
			},
			{
				name:"_babylon.gui.min",
				location:"/widgets/MxBabylonJS/lib/babylonjs/gui",
				main:"babylon.gui.min"
			},
			{
				name:"_babylon.inspector.bundle",
				location:"/widgets/MxBabylonJS/lib/babylonjs/inspector",
				main:"babylon.inspector.bundle"
			},
			{
				name:"_babylon.inspector.bundle.max",
				location:"/widgets/MxBabylonJS/lib/babylonjs/inspector",
				main:"babylon.inspector.bundle.max"
			},
			{
				name:"_babylon.inspector",
				location:"/widgets/MxBabylonJS/lib/babylonjs/inspector",
				main:"babylon.inspector"
			},
			{
				name:"_babylon.inspector.min",
				location:"/widgets/MxBabylonJS/lib/babylonjs/inspector",
				main:"babylon.inspector.min"
			},
			{
				name:"_babylon.glTF1FileLoader",
				location:"/widgets/MxBabylonJS/lib/babylonjs/loaders",
				main:"babylon.glTF1FileLoader"
			},
			{
				name:"_babylon.glTF1FileLoader.min",
				location:"/widgets/MxBabylonJS/lib/babylonjs/loaders",
				main:"babylon.glTF1FileLoader.min"
			},
			{
				name:"_babylon.glTF2FileLoader",
				location:"/widgets/MxBabylonJS/lib/babylonjs/loaders",
				main:"babylon.glTF2FileLoader"
			},
			{
				name:"_babylon.glTF2FileLoader.min",
				location:"/widgets/MxBabylonJS/lib/babylonjs/loaders",
				main:"babylon.glTF2FileLoader.min"
			},
			{
				name:"_babylon.glTFFileLoader",
				location:"/widgets/MxBabylonJS/lib/babylonjs/loaders",
				main:"babylon.glTFFileLoader"
			},
			{
				name:"_babylon.glTFFileLoader.min",
				location:"/widgets/MxBabylonJS/lib/babylonjs/loaders",
				main:"babylon.glTFFileLoader.min"
			},
			{
				name:"_babylon.objFileLoader",
				location:"/widgets/MxBabylonJS/lib/babylonjs/loaders",
				main:"babylon.objFileLoader"
			},
			{
				name:"_babylon.objFileLoader.min",
				location:"/widgets/MxBabylonJS/lib/babylonjs/loaders",
				main:"babylon.objFileLoader.min"
			},
			{
				name:"_babylon.stlFileLoader",
				location:"/widgets/MxBabylonJS/lib/babylonjs/loaders",
				main:"babylon.stlFileLoader"
			},
			{
				name:"_babylon.stlFileLoader.min",
				location:"/widgets/MxBabylonJS/lib/babylonjs/loaders",
				main:"babylon.stlFileLoader.min"
			},
			{
				name:"_babylonjs.loaders",
				location:"/widgets/MxBabylonJS/lib/babylonjs/loaders",
				main:"babylonjs.loaders"
			},
			{
				name:"_babylonjs.loaders.min",
				location:"/widgets/MxBabylonJS/lib/babylonjs/loaders",
				main:"babylonjs.loaders.min"
			},
			{
				name:"_babylon.backgroundMaterial",
				location:"/widgets/MxBabylonJS/lib/babylonjs/materialsLibrary",
				main:"babylon.backgroundMaterial"
			},
			{
				name:"_babylon.backgroundMaterial.min",
				location:"/widgets/MxBabylonJS/lib/babylonjs/materialsLibrary",
				main:"babylon.backgroundMaterial.min"
			},
			{
				name:"_babylon.cellMaterial",
				location:"/widgets/MxBabylonJS/lib/babylonjs/materialsLibrary",
				main:"babylon.cellMaterial"
			},
			{
				name:"_babylon.cellMaterial.min",
				location:"/widgets/MxBabylonJS/lib/babylonjs/materialsLibrary",
				main:"babylon.cellMaterial.min"
			},
			{
				name:"_babylon.customMaterial",
				location:"/widgets/MxBabylonJS/lib/babylonjs/materialsLibrary",
				main:"babylon.customMaterial"
			},
			{
				name:"_babylon.customMaterial.min",
				location:"/widgets/MxBabylonJS/lib/babylonjs/materialsLibrary",
				main:"babylon.customMaterial.min"
			},
			{
				name:"_babylon.fireMaterial",
				location:"/widgets/MxBabylonJS/lib/babylonjs/materialsLibrary",
				main:"babylon.fireMaterial"
			},
			{
				name:"_babylon.fireMaterial.min",
				location:"/widgets/MxBabylonJS/lib/babylonjs/materialsLibrary",
				main:"babylon.fireMaterial.min"
			},
			{
				name:"_babylon.furMaterial",
				location:"/widgets/MxBabylonJS/lib/babylonjs/materialsLibrary",
				main:"babylon.furMaterial"
			},
			{
				name:"_babylon.furMaterial.min",
				location:"/widgets/MxBabylonJS/lib/babylonjs/materialsLibrary",
				main:"babylon.furMaterial.min"
			},
			{
				name:"_babylon.gradientMaterial",
				location:"/widgets/MxBabylonJS/lib/babylonjs/materialsLibrary",
				main:"babylon.gradientMaterial"
			},
			{
				name:"_babylon.gradientMaterial.min",
				location:"/widgets/MxBabylonJS/lib/babylonjs/materialsLibrary",
				main:"babylon.gradientMaterial.min"
			},
			{
				name:"_babylon.gridMaterial",
				location:"/widgets/MxBabylonJS/lib/babylonjs/materialsLibrary",
				main:"babylon.gridMaterial"
			},
			{
				name:"_babylon.gridMaterial.min",
				location:"/widgets/MxBabylonJS/lib/babylonjs/materialsLibrary",
				main:"babylon.gridMaterial.min"
			},
			{
				name:"_babylon.lavaMaterial",
				location:"/widgets/MxBabylonJS/lib/babylonjs/materialsLibrary",
				main:"babylon.lavaMaterial"
			},
			{
				name:"_babylon.lavaMaterial.min",
				location:"/widgets/MxBabylonJS/lib/babylonjs/materialsLibrary",
				main:"babylon.lavaMaterial.min"
			},
			{
				name:"_babylon.mixMaterial",
				location:"/widgets/MxBabylonJS/lib/babylonjs/materialsLibrary",
				main:"babylon.mixMaterial"
			},
			{
				name:"_babylon.mixMaterial.min",
				location:"/widgets/MxBabylonJS/lib/babylonjs/materialsLibrary",
				main:"babylon.mixMaterial.min"
			},
			{
				name:"_babylon.normalMaterial",
				location:"/widgets/MxBabylonJS/lib/babylonjs/materialsLibrary",
				main:"babylon.normalMaterial"
			},
			{
				name:"_babylon.normalMaterial.min",
				location:"/widgets/MxBabylonJS/lib/babylonjs/materialsLibrary",
				main:"babylon.normalMaterial.min"
			},
			{
				name:"_babylon.shadowOnlyMaterial",
				location:"/widgets/MxBabylonJS/lib/babylonjs/materialsLibrary",
				main:"babylon.shadowOnlyMaterial"
			},
			{
				name:"_babylon.shadowOnlyMaterial.min",
				location:"/widgets/MxBabylonJS/lib/babylonjs/materialsLibrary",
				main:"babylon.shadowOnlyMaterial.min"
			},
			{
				name:"_babylon.simpleMaterial",
				location:"/widgets/MxBabylonJS/lib/babylonjs/materialsLibrary",
				main:"babylon.simpleMaterial"
			},
			{
				name:"_babylon.simpleMaterial.min",
				location:"/widgets/MxBabylonJS/lib/babylonjs/materialsLibrary",
				main:"babylon.simpleMaterial.min"
			},
			{
				name:"_babylon.skyMaterial",
				location:"/widgets/MxBabylonJS/lib/babylonjs/materialsLibrary",
				main:"babylon.skyMaterial"
			},
			{
				name:"_babylon.skyMaterial.min",
				location:"/widgets/MxBabylonJS/lib/babylonjs/materialsLibrary",
				main:"babylon.skyMaterial.min"
			},
			{
				name:"_babylon.terrainMaterial",
				location:"/widgets/MxBabylonJS/lib/babylonjs/materialsLibrary",
				main:"babylon.terrainMaterial"
			},
			{
				name:"_babylon.terrainMaterial.min",
				location:"/widgets/MxBabylonJS/lib/babylonjs/materialsLibrary",
				main:"babylon.terrainMaterial.min"
			},
			{
				name:"_babylon.triPlanarMaterial",
				location:"/widgets/MxBabylonJS/lib/babylonjs/materialsLibrary",
				main:"babylon.triPlanarMaterial"
			},
			{
				name:"_babylon.triPlanarMaterial.min",
				location:"/widgets/MxBabylonJS/lib/babylonjs/materialsLibrary",
				main:"babylon.triPlanarMaterial.min"
			},
			{
				name:"_babylon.waterMaterial",
				location:"/widgets/MxBabylonJS/lib/babylonjs/materialsLibrary",
				main:"babylon.waterMaterial"
			},
			{
				name:"_babylon.waterMaterial.min",
				location:"/widgets/MxBabylonJS/lib/babylonjs/materialsLibrary",
				main:"babylon.waterMaterial.min"
			},
			{
				name:"_babylonjs.materials",
				location:"/widgets/MxBabylonJS/lib/babylonjs/materialsLibrary",
				main:"babylonjs.materials"
			},
			{
				name:"_babylonjs.materials.min",
				location:"/widgets/MxBabylonJS/lib/babylonjs/materialsLibrary",
				main:"babylonjs.materials.min"
			},
			{
				name:"_Oimo",
				location:"/widgets/MxBabylonJS/lib/babylonjs",
				main:"Oimo"
			},
			{
				name:"_babylon.asciiArtPostProcess",
				location:"/widgets/MxBabylonJS/lib/babylonjs/postProcessLibrary",
				main:"babylon.asciiArtPostProcess"
			},
			{
				name:"_babylon.asciiArtPostProcess.min",
				location:"/widgets/MxBabylonJS/lib/babylonjs/postProcessLibrary",
				main:"babylon.asciiArtPostProcess.min"
			},
			{
				name:"_babylon.digitalRainPostProcess",
				location:"/widgets/MxBabylonJS/lib/babylonjs/postProcessLibrary",
				main:"babylon.digitalRainPostProcess"
			},
			{
				name:"_babylon.digitalRainPostProcess.min",
				location:"/widgets/MxBabylonJS/lib/babylonjs/postProcessLibrary",
				main:"babylon.digitalRainPostProcess.min"
			},
			{
				name:"_babylon.oceanPostProcess",
				location:"/widgets/MxBabylonJS/lib/babylonjs/postProcessLibrary",
				main:"babylon.oceanPostProcess"
			},
			{
				name:"_babylon.oceanPostProcess.min",
				location:"/widgets/MxBabylonJS/lib/babylonjs/postProcessLibrary",
				main:"babylon.oceanPostProcess.min"
			},
			{
				name:"_babylonjs.postProcess",
				location:"/widgets/MxBabylonJS/lib/babylonjs/postProcessLibrary",
				main:"babylonjs.postProcess"
			},
			{
				name:"_babylonjs.postProcess.min",
				location:"/widgets/MxBabylonJS/lib/babylonjs/postProcessLibrary",
				main:"babylonjs.postProcess.min"
			},
			{
				name:"_babylon.brickProceduralTexture",
				location:"/widgets/MxBabylonJS/lib/babylonjs/proceduralTexturesLibrary",
				main:"babylon.brickProceduralTexture"
			},
			{
				name:"_babylon.brickProceduralTexture.min",
				location:"/widgets/MxBabylonJS/lib/babylonjs/proceduralTexturesLibrary",
				main:"babylon.brickProceduralTexture.min"
			},
			{
				name:"_babylon.cloudProceduralTexture",
				location:"/widgets/MxBabylonJS/lib/babylonjs/proceduralTexturesLibrary",
				main:"babylon.cloudProceduralTexture"
			},
			{
				name:"_babylon.cloudProceduralTexture.min",
				location:"/widgets/MxBabylonJS/lib/babylonjs/proceduralTexturesLibrary",
				main:"babylon.cloudProceduralTexture.min"
			},
			{
				name:"_babylon.fireProceduralTexture",
				location:"/widgets/MxBabylonJS/lib/babylonjs/proceduralTexturesLibrary",
				main:"babylon.fireProceduralTexture"
			},
			{
				name:"_babylon.fireProceduralTexture.min",
				location:"/widgets/MxBabylonJS/lib/babylonjs/proceduralTexturesLibrary",
				main:"babylon.fireProceduralTexture.min"
			},
			{
				name:"_babylon.grassProceduralTexture",
				location:"/widgets/MxBabylonJS/lib/babylonjs/proceduralTexturesLibrary",
				main:"babylon.grassProceduralTexture"
			},
			{
				name:"_babylon.grassProceduralTexture.min",
				location:"/widgets/MxBabylonJS/lib/babylonjs/proceduralTexturesLibrary",
				main:"babylon.grassProceduralTexture.min"
			},
			{
				name:"_babylon.marbleProceduralTexture",
				location:"/widgets/MxBabylonJS/lib/babylonjs/proceduralTexturesLibrary",
				main:"babylon.marbleProceduralTexture"
			},
			{
				name:"_babylon.marbleProceduralTexture.min",
				location:"/widgets/MxBabylonJS/lib/babylonjs/proceduralTexturesLibrary",
				main:"babylon.marbleProceduralTexture.min"
			},
			{
				name:"_babylon.normalMapProceduralTexture",
				location:"/widgets/MxBabylonJS/lib/babylonjs/proceduralTexturesLibrary",
				main:"babylon.normalMapProceduralTexture"
			},
			{
				name:"_babylon.normalMapProceduralTexture.min",
				location:"/widgets/MxBabylonJS/lib/babylonjs/proceduralTexturesLibrary",
				main:"babylon.normalMapProceduralTexture.min"
			},
			{
				name:"_babylon.perlinNoiseProceduralTexture",
				location:"/widgets/MxBabylonJS/lib/babylonjs/proceduralTexturesLibrary",
				main:"babylon.perlinNoiseProceduralTexture"
			},
			{
				name:"_babylon.perlinNoiseProceduralTexture.min",
				location:"/widgets/MxBabylonJS/lib/babylonjs/proceduralTexturesLibrary",
				main:"babylon.perlinNoiseProceduralTexture.min"
			},
			{
				name:"_babylon.roadProceduralTexture",
				location:"/widgets/MxBabylonJS/lib/babylonjs/proceduralTexturesLibrary",
				main:"babylon.roadProceduralTexture"
			},
			{
				name:"_babylon.roadProceduralTexture.min",
				location:"/widgets/MxBabylonJS/lib/babylonjs/proceduralTexturesLibrary",
				main:"babylon.roadProceduralTexture.min"
			},
			{
				name:"_babylon.starfieldProceduralTexture",
				location:"/widgets/MxBabylonJS/lib/babylonjs/proceduralTexturesLibrary",
				main:"babylon.starfieldProceduralTexture"
			},
			{
				name:"_babylon.starfieldProceduralTexture.min",
				location:"/widgets/MxBabylonJS/lib/babylonjs/proceduralTexturesLibrary",
				main:"babylon.starfieldProceduralTexture.min"
			},
			{
				name:"_babylon.waterProceduralTexture",
				location:"/widgets/MxBabylonJS/lib/babylonjs/proceduralTexturesLibrary",
				main:"babylon.waterProceduralTexture"
			},
			{
				name:"_babylon.waterProceduralTexture.min",
				location:"/widgets/MxBabylonJS/lib/babylonjs/proceduralTexturesLibrary",
				main:"babylon.waterProceduralTexture.min"
			},
			{
				name:"_babylon.woodProceduralTexture",
				location:"/widgets/MxBabylonJS/lib/babylonjs/proceduralTexturesLibrary",
				main:"babylon.woodProceduralTexture"
			},
			{
				name:"_babylon.woodProceduralTexture.min",
				location:"/widgets/MxBabylonJS/lib/babylonjs/proceduralTexturesLibrary",
				main:"babylon.woodProceduralTexture.min"
			},
			{
				name:"_babylonjs.proceduralTextures",
				location:"/widgets/MxBabylonJS/lib/babylonjs/proceduralTexturesLibrary",
				main:"babylonjs.proceduralTextures"
			},
			{
				name:"_babylonjs.proceduralTextures.min",
				location:"/widgets/MxBabylonJS/lib/babylonjs/proceduralTexturesLibrary",
				main:"babylonjs.proceduralTextures.min"
			},
			{
				name:"_babylon.glTF2Serializer",
				location:"/widgets/MxBabylonJS/lib/babylonjs/serializers",
				main:"babylon.glTF2Serializer"
			},
			{
				name:"_babylon.glTF2Serializer.min",
				location:"/widgets/MxBabylonJS/lib/babylonjs/serializers",
				main:"babylon.glTF2Serializer.min"
			},
			{
				name:"_babylon.objSerializer",
				location:"/widgets/MxBabylonJS/lib/babylonjs/serializers",
				main:"babylon.objSerializer"
			},
			{
				name:"_babylon.objSerializer.min",
				location:"/widgets/MxBabylonJS/lib/babylonjs/serializers",
				main:"babylon.objSerializer.min"
			},
			{
				name:"_babylonjs.serializers",
				location:"/widgets/MxBabylonJS/lib/babylonjs/serializers",
				main:"babylonjs.serializers"
			},
			{
				name:"_babylonjs.serializers.min",
				location:"/widgets/MxBabylonJS/lib/babylonjs/serializers",
				main:"babylonjs.serializers.min"
			},
			{
				name:"_split",
				location:"/widgets/MxBabylonJS/lib/babylonjs",
				main:"split"
			},
			{
				name:"_babylon.viewer",
				location:"/widgets/MxBabylonJS/lib/babylonjs/viewer",
				main:"babylon.viewer"
			},
			{
				name:"_babylon.viewer.max",
				location:"/widgets/MxBabylonJS/lib/babylonjs/viewer",
				main:"babylon.viewer.max"
			},
			{
				name:"_jquery-1.11.2",
				location:"/widgets/MxBabylonJS/lib",
				main:"jquery-1.11.2"
			},
			*/
			/*
			 * cdn
			 */
			{
				name:'babylonjs',
				//location:'https://preview.babylonjs.com/',
				location:'/widgets/MxBabylonJS/lib/babylonjscdn',
				main:'babylon.max',
			},
			{
				name:'babylonjs_materials',
				//location:'https://preview.babylonjs.com/materialsLibrary',
				location:'/widgets/MxBabylonJS/lib/babylonjscdn',
				main:'babylonjs.materials',
			},
			{
				name:'pep',
				//location:'https://code.jquery.com/pep/0.4.3',
				location:'/widgets/MxBabylonJS/lib/babylonjscdn',
				main:'pep',
			},
			/* ???
			shim : {
				babylonjs: {deps: ['pep']}
			}
			*/
		]
	},
	[
		'dojo/_base/declare',
		'mxui/widget/_WidgetBase',
		'dijit/_TemplatedMixin',
		'mxui/dom',
		'dojo/dom',
		'dojo/dom-prop',
		'dojo/dom-geometry',
		'dojo/dom-class',
		'dojo/dom-style',
		'dojo/dom-construct',
		'dojo/_base/array',
		'dojo/_base/lang',
		'dojo/text',
		'dojo/html',
		'dojo/_base/event',
		'MxBabylonJS/lib/jquery-1.11.2',
//		'_ammo',
//		'_babylon',
//		'_babylon.max',
//		'_babylon.no-module.max',
//		'_babylon.worker',
//		'_cannon',
//		'_draco_decoder_gltf',
//		'_draco_wasm_wrapper_gltf',
//		'_earcut.min',
//		'_es6',
//		'_gltf_validator',
//		'_babylon.gui',
//		'_babylon.gui.min',
//		'_babylon.inspector.bundle',
//		'_babylon.inspector.bundle.max',
//		'_babylon.inspector',
//		'_babylon.inspector.min',
//		'_babylon.glTF1FileLoader',
//		'_babylon.glTF1FileLoader.min',
//		'_babylon.glTF2FileLoader',
//		'_babylon.glTF2FileLoader.min',
//		'_babylon.glTFFileLoader',
//		'_babylon.glTFFileLoader.min',
//		'_babylon.objFileLoader',
//		'_babylon.objFileLoader.min',
//		'_babylon.stlFileLoader',
//		'_babylon.stlFileLoader.min',
//		'_babylonjs.loaders',
//		'_babylonjs.loaders.min',
//		'_babylon.backgroundMaterial',
//		'_babylon.backgroundMaterial.min',
//		'_babylon.cellMaterial',
//		'_babylon.cellMaterial.min',
//		'_babylon.customMaterial',
//		'_babylon.customMaterial.min',
//		'_babylon.fireMaterial',
//		'_babylon.fireMaterial.min',
//		'_babylon.furMaterial',
//		'_babylon.furMaterial.min',
//		'_babylon.gradientMaterial',
//		'_babylon.gradientMaterial.min',
//		'_babylon.gridMaterial',
//		'_babylon.gridMaterial.min',
//		'_babylon.lavaMaterial',
//		'_babylon.lavaMaterial.min',
//		'_babylon.mixMaterial',
//		'_babylon.mixMaterial.min',
//		'_babylon.normalMaterial',
//		'_babylon.normalMaterial.min',
//		'_babylon.shadowOnlyMaterial',
//		'_babylon.shadowOnlyMaterial.min',
//		'_babylon.simpleMaterial',
//		'_babylon.simpleMaterial.min',
//		'_babylon.skyMaterial',
//		'_babylon.skyMaterial.min',
//		'_babylon.terrainMaterial',
//		'_babylon.terrainMaterial.min',
//		'_babylon.triPlanarMaterial',
//		'_babylon.triPlanarMaterial.min',
//		'_babylon.waterMaterial',
//		'_babylon.waterMaterial.min',
//		'_babylonjs.materials',
//		'_babylonjs.materials.min',
//		'_Oimo',
//		'_babylon.asciiArtPostProcess',
//		'_babylon.asciiArtPostProcess.min',
//		'_babylon.digitalRainPostProcess',
//		'_babylon.digitalRainPostProcess.min',
//		'_babylon.oceanPostProcess',
//		'_babylon.oceanPostProcess.min',
//		'_babylonjs.postProcess',
//		'_babylonjs.postProcess.min',
//		'_babylon.brickProceduralTexture',
//		'_babylon.brickProceduralTexture.min',
//		'_babylon.cloudProceduralTexture',
//		'_babylon.cloudProceduralTexture.min',
//		'_babylon.fireProceduralTexture',
//		'_babylon.fireProceduralTexture.min',
//		'_babylon.grassProceduralTexture',
//		'_babylon.grassProceduralTexture.min',
//		'_babylon.marbleProceduralTexture',
//		'_babylon.marbleProceduralTexture.min',
//		'_babylon.normalMapProceduralTexture',
//		'_babylon.normalMapProceduralTexture.min',
//		'_babylon.perlinNoiseProceduralTexture',
//		'_babylon.perlinNoiseProceduralTexture.min',
//		'_babylon.roadProceduralTexture',
//		'_babylon.roadProceduralTexture.min',
//		'_babylon.starfieldProceduralTexture',
//		'_babylon.starfieldProceduralTexture.min',
//		'_babylon.waterProceduralTexture',
//		'_babylon.waterProceduralTexture.min',
//		'_babylon.woodProceduralTexture',
//		'_babylon.woodProceduralTexture.min',
//		'_babylonjs.proceduralTextures',
//		'_babylonjs.proceduralTextures.min',
//		'_babylon.glTF2Serializer',
//		'_babylon.glTF2Serializer.min',
//		'_babylon.objSerializer',
//		'_babylon.objSerializer.min',
//		'_babylonjs.serializers',
//		'_babylonjs.serializers.min',
//		'_split',
//		'_babylon.viewer',
//		'_babylon.viewer.max',
//cdn
		'babylonjs',
		'babylonjs_materials',
		'pep',
		'dojo/text!MxBabylonJS/widget/template/MxBabylonJS.html'
	],
	function(
		declare,
		_WidgetBase,
		_TemplatedMixin,
		dom,
		dojoDom,
		dojoProp,
		dojoGeometry,
		dojoClass,
		dojoStyle,
		dojoConstruct,
		dojoArray,
		lang,
		dojoText,
		dojoHtml,
		dojoEvent,
		_jQuery,
//local
//		_ammo,
//		_babylon,
//		_babylon_max,
//		_babylon_no-module_max,
//		_babylon_worker,
//		_cannon,
//		_draco_decoder_gltf,
//		_draco_wasm_wrapper_gltf,
//		_earcut_min,
//		_es6,
//		_gltf_validator,
//		_babylon_gui,
//		_babylon_gui_min,
//		_babylon_inspector_bundle,
//		_babylon_inspector_bundle_max,
//		_babylon_inspector,
//		_babylon_inspector_min,
//		_babylon_glTF1FileLoader,
//		_babylon_glTF1FileLoader_min,
//		_babylon_glTF2FileLoader,
//		_babylon_glTF2FileLoader_min,
//		_babylon_glTFFileLoader,
//		_babylon_glTFFileLoader_min,
//		_babylon_objFileLoader,
//		_babylon_objFileLoader_min,
//		_babylon_stlFileLoader,
//		_babylon_stlFileLoader_min,
//		_babylonjs_loaders,
//		_babylonjs_loaders_min,
//		_babylon_backgroundMaterial,
//		_babylon_backgroundMaterial_min,
//		_babylon_cellMaterial,
//		_babylon_cellMaterial_min,
//		_babylon_customMaterial,
//		_babylon_customMaterial_min,
//		_babylon_fireMaterial,
//		_babylon_fireMaterial_min,
//		_babylon_furMaterial,
//		_babylon_furMaterial_min,
//		_babylon_gradientMaterial,
//		_babylon_gradientMaterial_min,
//		_babylon_gridMaterial,
//		_babylon_gridMaterial_min,
//		_babylon_lavaMaterial,
//		_babylon_lavaMaterial_min,
//		_babylon_mixMaterial,
//		_babylon_mixMaterial_min,
//		_babylon_normalMaterial,
//		_babylon_normalMaterial_min,
//		_babylon_shadowOnlyMaterial,
//		_babylon_shadowOnlyMaterial_min,
//		_babylon_simpleMaterial,
//		_babylon_simpleMaterial_min,
//		_babylon_skyMaterial,
//		_babylon_skyMaterial_min,
//		_babylon_terrainMaterial,
//		_babylon_terrainMaterial_min,
//		_babylon_triPlanarMaterial,
//		_babylon_triPlanarMaterial_min,
//		_babylon_waterMaterial,
//		_babylon_waterMaterial_min,
//		_babylonjs_materials,
//		_babylonjs_materials_min,
//		_Oimo,
//		_babylon_asciiArtPostProcess,
//		_babylon_asciiArtPostProcess_min,
//		_babylon_digitalRainPostProcess,
//		_babylon_digitalRainPostProcess_min,
//		_babylon_oceanPostProcess,
//		_babylon_oceanPostProcess_min,
//		_babylonjs_postProcess,
//		_babylonjs_postProcess_min,
//		_babylon_brickProceduralTexture,
//		_babylon_brickProceduralTexture_min,
//		_babylon_cloudProceduralTexture,
//		_babylon_cloudProceduralTexture_min,
//		_babylon_fireProceduralTexture,
//		_babylon_fireProceduralTexture_min,
//		_babylon_grassProceduralTexture,
//		_babylon_grassProceduralTexture_min,
//		_babylon_marbleProceduralTexture,
//		_babylon_marbleProceduralTexture_min,
//		_babylon_normalMapProceduralTexture,
//		_babylon_normalMapProceduralTexture_min,
//		_babylon_perlinNoiseProceduralTexture,
//		_babylon_perlinNoiseProceduralTexture_min,
//		_babylon_roadProceduralTexture,
//		_babylon_roadProceduralTexture_min,
//		_babylon_starfieldProceduralTexture,
//		_babylon_starfieldProceduralTexture_min,
//		_babylon_waterProceduralTexture,
//		_babylon_waterProceduralTexture_min,
//		_babylon_woodProceduralTexture,
//		_babylon_woodProceduralTexture_min,
//		_babylonjs_proceduralTextures,
//		_babylonjs_proceduralTextures_min,
//		_babylon_glTF2Serializer,
//		_babylon_glTF2Serializer_min,
//		_babylon_objSerializer,
//		_babylon_objSerializer_min,
//		_babylonjs_serializers,
//		_babylonjs_serializers_min,
//		_split,
//		_babylon_viewer,
//		_babylon_viewer_max,
//cdn
		babylonjs,
		babylonjs_materials,
		pep,
		widgetTemplate
	){
		"use strict";
		var $ = _jQuery.noConflict(true);
		return declare(
			"MxBabylonJS.widget.MxBabylonJS",
			[
				_WidgetBase,
				_TemplatedMixin
			],{
				templateString:widgetTemplate,
				widgetBase:null,
				_handles:null,
				_contextObj:null,
				constructor:function(){
					this._handles=[];
				},
				postCreate:function(){
					mx.ui.info('test5');
					console.log('1----------------------------------------')
					this.domNode.appendChild(
						dojo.create(
							"canvas",
							{
								'id':'renderCanvas',//this.id+'_canvas',
								'touch-action':'none',
								'width':'320px',
								'height':'320px'
							}
						)
					);
					/*
					console.log('2----------------------------------------')
					this.engine=new BABYLON.Engine(this.canvas,true);
					console.log('z----------------------------------------')
					this.scene=this.createScene(this.engine,this.canvas);
					console.log(this.scene);
					console.log('5----------------------------------------')
					var _this=this;
					this.engine.runRenderLoop(function(){_this.scene.render();});
					*/
var canvas = document.getElementById("renderCanvas"); // Get the canvas element 
        var engine = new BABYLON.Engine(canvas, true); // Generate the BABYLON 3D engine

        /******* Add the create scene function ******/
        var createScene = function () {

            // Create the scene space
            var scene = new BABYLON.Scene(engine);

            // Add a camera to the scene and attach it to the canvas
            var camera = new BABYLON.ArcRotateCamera("Camera", Math.PI / 2, Math.PI / 2, 2, new BABYLON.Vector3(0,0,5), scene);
            camera.attachControl(canvas, true);

            // Add lights to the scene
            var light1 = new BABYLON.HemisphericLight("light1", new BABYLON.Vector3(1, 1, 0), scene);
            var light2 = new BABYLON.PointLight("light2", new BABYLON.Vector3(0, 1, -1), scene);

            // Add and manipulate meshes in the scene
            var sphere = BABYLON.MeshBuilder.CreateSphere("sphere", {diameter:2}, scene);

            return scene;
        };
        /******* End of the create scene function ******/    

        var scene = createScene(); //Call the createScene function

        // Register a render loop to repeatedly render the scene
        engine.runRenderLoop(function () { 
                scene.render();
        });

        // Watch for browser/canvas resize events
        window.addEventListener("resize", function () { 
                engine.resize();
        });
				},
				update:function(obj,callback){
					this._contextObj=obj;
					this._updateRendering(callback);
				},
				resize:function(box){
				},
				uninitialize:function(){
				},
				_updateRendering:function(callback){
					/*
					if(this._contextObj!==null){
						dojoStyle.set(this.domNode,"display","block");
					}else{
						dojoStyle.set(this.domNode,"display","none")	;
					}
					*/
					this._executeCallback(callback,"_updateRendering");
				},
				_execMf:function(mf,guid,cb){
					if(mf&&guid){
						mx.ui.action(mf,{
							params:{
								applyto:"selection",
								guids:[guid]
							},
							callback:lang.hitch(this,function(objs){
								if(cb&&typeof cb==="function"){
									cb(objs);
								}
							}),
							error:function(error){
								console.debug(error.description);
							}
						},this);
					}
				},
				_executeCallback:function(cb,from){
					if(cb&&typeof cb==="function"){
						cb();
					}
				},
				createScene:function(engine,canvas){
					console.log('3----------------------------------------')
					console.log('createscene');
					//ThiscreatesabasicBabylonSceneobject(non-mesh)
					var scene=new BABYLON.Scene(engine);
					//Thiscreatesandpositionsafreecamera(non-mesh)
					var camera=new BABYLON.FreeCamera("camera1",new BABYLON.Vector3(0,5,-10),scene);
					//Thistargetsthecameratosceneorigin
					camera.setTarget(BABYLON.Vector3.Zero());
					//Thisattachesthecameratothecanvas
					camera.attachControl(canvas,true);
					//Thiscreatesalight,aiming0,1,0-tothesky(non-mesh)
					var light=new BABYLON.HemisphericLight("light",new BABYLON.Vector3(0,1,0),scene);
					//Defaultintensityis1.Let'sdimthelightasmallamount
					light.intensity=0.7;
					//Ourbuilt-in'sphere'shape.
					var sphere=BABYLON.MeshBuilder.CreateSphere("sphere",{diameter:2,segments:32},scene);
					//Movethesphereupward1/2itsheight
					sphere.position.y=1;
					//Ourbuilt-in'ground'shape.
					var ground=BABYLON.MeshBuilder.CreateGround("ground",{width:6,height:6},scene);
					console.log('4----------------------------------------')
					return scene;
				}
		});
	}
);
//require(["MxBabylonJS/widget/MxBabylonJS"]);
